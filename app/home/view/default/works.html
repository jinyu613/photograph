<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>发布作品</title>
    <!--防止IE进入怪异模式-->
    <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    {include file="public:head"/}
</head>
	<body>
		  <div class="header other-page">
      {include file="public:nav"}

    </div>
		<div class="fbzp-m clearfix" id="base_create">
			<form action="{:url('Login/announce')}" method="post" enctype="multipart/form-data">
			<div class="fbzp-left fl">

				<div class="fbzp-ls1">
                    <div class="button-box">
                        <button type="button" class="buttn" id="goods_img" >添加图片</button>
                        <div style="display: none" id="demo1"></div>
                        <p>点击ctrl或shift可以选择多张图片上传<br />或者将照片拖放到此页窗口的任何位置<br />大小:小于10MB ,格式: JPEG/PNG/GIF<br />建议图片长边大于2000px</p>
                    </div>

				</div>


				<div class="image_item_wrap js-image-item">


					<div class="image-item">
						<input type="hidden" data-value="" class="js-image-id" value="304101175">
						<div class="image-content" style="background-image: url({$yf_theme_path}public/images/img6.png)">
							<div class="error-mask">
								<div class="loadding-white"></div>
								<div class="loadding-green"></div>
							</div>
							<div class="cover-image-label" style=""></div>
							<div class="hover-option-container"></div>
							<div class="hover-option-content">
								<div class="option-item">设为封面</div>
								<div class="option-item">删除照片</div>
							</div>
						</div>
					</div>


				</div>

				<div class="image_item_wrap" id="add">
					<div class="add-image-button">
						<div class="iconfont icon-add add-font">+</div>
						<div class="button-tip">添加更多图片</div>
						<div class="add-image-tip">大小：小于10MB</div>
						<div class="add-image-tip">格式：JPEG/PNG/GIF</div>
						<div class="add-image-tip">可拖拽上传</div>
						<input type="file" class="add-image-input">
					</div>
				</div>
				<script>
                    layui.use('upload', function(){
                        var $ = layui.jquery
                            ,upload = layui.upload;
                        //多图片上传
                        upload.render({
                            elem: '#add'
                            ,url: '{:url("Upload/index")}'
                            ,accept:'file'
                            ,size: 0
                            ,multiple: false
                            ,before: function(obj){
                                //预读本地文件示例，不支持ie8
                                obj.preview(function(index, file, result){
                                    // console.log(index)
                                });
                            }
                            ,done: function(res){
                                if(res.code>0){
                                    alert('上传失败');
                                }else {
                                    var html = '<img src="'+res["data"]["src"]+'" width="100px">' +
                                        '<input type="hidden"  name="news_pic_allurl_name[]"  value="'+res["name"]+'" /><input type="hidden"  name="news_pic_allurl[]"  value="'+res["data"]["src"]+'" />';
                                    $('.fbzp-left').append(html);
                                    console.log(res)
                                }
                            }
                        });
                    });
				</script>
				<script type="text/javascript">
					$("#base_create .hover-option-content").mousemove(function () {
//						alert(1);
                    })
				</script>

                <script>
                    layui.use('upload', function(){
                        var $ = layui.jquery
                            ,upload = layui.upload;
                        //多图片上传
                        upload.render({
                            elem: '#goods_img'
                            ,url: '{:url("Upload/index")}'
                            ,accept:'file'
                            ,size: 0
                            ,multiple: false
                            ,before: function(obj){
                                //预读本地文件示例，不支持ie8
                                obj.preview(function(index, file, result){
                                   // console.log(index)
                                });
                            }
                            ,done: function(res){
                                if(res.code>0){
                                    alert('上传失败');
                                }else {
                                    var html = '<img src="'+res["data"]["src"]+'" width="100px">' +
                                        '<input type="hidden"  name="news_pic_allurl_name[]"  value="'+res["name"]+'" /><input type="hidden"  name="news_pic_allurl[]"  value="'+res["data"]["src"]+'" />';
                                    $('.fbzp-left').append(html);
                                    console.log(res)
                                }
                            }
                        });
                    });
                </script>
			</div>
			<div class="fbzp-right fr bgfff">

					<div class="info-group">
					<span>标题</span>
					<input type="text" name="news_title"  value="" />
				</div>
				<div class="info-group">
					<span>作品分类<em class="em-cred">*</em></span>
					<select name="assortment_id">
						<option value="">请选择</option>
						{foreach $classify as $k=>$v}
						<option value="{$v.id}">{$v.assortment_name}</option>
						{/foreach}
					</select>
				</div>
				<div class="info-group">
					<span>描述</span>
					<textarea name="news_titleshort" rows="" cols="" placeholder="请输入作品描述"></textarea>
					
				</div>
				<div class="info-group ing-bq">
					<span>标签</span>
					<input type="text" class="label" /><a href="javascript:" class="a-tjbq">添加</a>
					<div class="jia">
						<br/>

					</div>
					<!--<p>参加活动：开学日的发现 在清晨与黄昏起飞 瞰见春天 青春故事</p>-->
				</div>
					<script>
						$(function () {
							$('.a-tjbq').click(function () {
								var label = $('.label').val();
								console.log(label);
                                var f = true;
                                if(label == null || label == "" || label == " "){
                                    f = false;
                                    console.log(f);
								};
								$(".jia .jia-box").each(function(){
									var t = $(this).text();
									if( t === label){
										f = false;
									};
								});
								if(f){
								    console.log(f);
									$.post("{:url('login/label_name')}",{name:label},function (res) {
										var html = '<div class="jia-box" style="border: #adadad 1px solid;display: inline-block;background-color: #adadad">'+res["pag_name"]+'</div>' +
											'<input type="hidden"  name="pag_id[]"  value="'+res["id"]+'" />';
										$('.jia').append(html);
										console.log(res);
									})
								}
                            })
                        })
					</script>
				<!--<div class="info-group">-->
					<!--<span>版权设置</span>-->
					<!--<select name="copyright">-->
						<!--<option value="">不添加版权信息</option>-->
						<!--{foreach $diyflag as $k=>$v}-->
						<!--<option value="{$v.diyflag_id}">{$v.diyflag_name}</option>-->
						<!--{/foreach}-->
					<!--</select>-->
				<!--</div>-->
				<!--<div class="info-group ing-bgmusic">-->
					<!--<span>背景音乐</span><em>目前支持网易云音乐、虾米音乐外链<a href="">?</a></em>-->
					<!--<input type="text" name="music" value="" placeholder="请添加音乐外链接地址"/>-->
				<!--</div>-->
				<!--<div class="btn-fbzp mt40">-->
					<!--<a href="" class="a-caogao">保存草稿</a><a href="" class="a-yulan ml20">预览</a>-->
				<!--</div>-->
				<div class="ht120">
					
				</div>
				<div class="fbzp-grop">
					<input type="submit" value="发布作品"/>
					<p>已添加 <em>0</em>/<em>40</em></p>
				</div>
					
				</form>
				
				
			</div>
		</div>
	</body>
</html>
